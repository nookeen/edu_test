<!doctype html>
<html>
  <head>
      
  </head>
  <body>
    
    <script src="assets/js/libs/jquery-3.3.1.min.js"></script>
    <script src="assets/js/libs/dexie.js"></script>
    <script src="assets/js/libs/hashids.min.js"></script>
    <script src="assets/js/libs/date.js"></script>
    
    <script>
          //var mydate = Date.now();
          //var result = mydate.toString('yyyy-MM-dd hh:mm:ss');
          //console.log(result);
          
          //
          // Define your database
          //
          var db = new Dexie('friend_database6');
          db.version(1).stores({
            friends: 'id,name,shoeSize,email',
            friends_list: 'name,number'
          });
          db.open().catch(function (err) {
            console.error (err.stack || err);
          });
          
      db.transaction("rw", db.friends_list, function() {
          db.friends_list.add({name: "Mans", number: 1}); // unhandled promise = ok!
          db.friends_list.add({name: "Nils", number: 2}); // unhandled promise = ok!
          db.friends_list.add({name: "Jon", number: 3});  // unhandled promise = ok!
          // If any of the promises above fails, transaction will abort and it's promise
          // reject.
      
          // Since we are in a transaction, we can query the table right away and
          // still get the results of the write operations above.
          var promise = db.friends_list.where("number").equals(1).toArray();
          
          console.log(promise);
          // Make the transaction resolve with the last promise result
          return promise;
      
      }).then(function (closeFriends) {
      
          // Transaction complete.
          console.log(closeFriends);
      
      }).catch(function (error) {
      
          // Log or display the error.
          console.error(error);
          // Notice that when using a transaction, it's enough to catch
          // the transaction Promise instead of each db operation promise.
      });
      
      function getJon() {
        return db.friends_list
        .where('name')
        .equals(['Jon'])
        .toArray()
        .catch('DataError', function (err) {
          console.log(err);
        });
      }
      console.log(getJon());
          
          //function getHillary() {
          //  return db.friends
          //  .where('[id]')
          //  .equals(['jhg'])
          //  .toArray()
          //  .catch('DataError', function (err) {
          //    // May fail in IE/Edge because it lacks support for compound keys.
          //    // Use a fallback method:
          //    return db.friends
          //      .where('id')
          //      .equals('jhg')
          //      .and(function (friend) {
          //        return friend.email == 'ap1@nookeen.com';
          //      });
          //  });
          //}
          //
          //console.log(getHillary());
          //
          //
          // Put some data into it
          //
          //db.friends.put({id: 'qwq', name: "Apple", shoeSize: 9, email: 'ap1@nookeen.com'});
          
          function x() {
            //return db.friends.get('jhg');
          }
          //var d = x();
          //d.then(function(xyz, el){
            //console.log("Nick has shoe size " + xyz.shoeSize);
            //console.log(xyz);
          //});
          
          /*
          db.friends.put({id: 'jhg', name: "Nick", shoeSize: 8, email: 'ap@nookeen.com'}).then (function(){
              //
              // Then when data is stored, read from it
              //
              
              //var request = window.indexedDB.open("friend_database", 10);
              //console.log(request);
              
              return db.friends.get('jhg');
          }).then(function (friend) {
              //
              // Display the result
              //
              console.log("Nick has shoe size " + friend.shoeSize);
              //alert ("Nicolas has shoe size " + friend.shoeSize);
          }).catch(function(error) {
             //
             // Finally don't forget to catch any error
             // that could have happened anywhere in the
             // code blocks above.
             //
             console.log("Ooops: " + error);
          });
          
          db.transaction("r", db.id_hash_number, function() {
          
          var promise = db.id_hash_number.where("section").equals(section).toArray();
          
          // Make the transaction resolve with the last promise result
          return promise;
      
      }).then(function (section_id) {
      
          // Transaction complete.
          console.log(section_id);
          console.log("HashSectionID: "+section_id);
      
      }).catch(function (error) {
      
          // Log or display the error.
          console.error(error);
          // Notice that when using a transaction, it's enough to catch
          // the transaction Promise instead of each db operation promise.
      });
          */
      </script>
  </body>
</html>